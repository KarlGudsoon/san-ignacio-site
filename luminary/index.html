<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Centro de Estudios San Ignacio</title>
    <link rel="stylesheet" href="public/global.css" />
    <link rel="stylesheet" href="/public/css/global.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="container-inicio">
      <div class="login-container">
        <a class="link" href="/"
          ><img
            class="arrow-icon"
            src="/assets/icon/arrow-white.svg"
            alt=""
          />Volver</a
        >
        <div class="login">
          <h1>Inicia Sesión en <span>Luminary</span></h1>
          <div
            id="mensaje-error"
            class="mensaje-error"
            style="
              display: none;
              background-color: rgba(240, 27, 27, 0.5);
              border: 1px solid rgba(240, 27, 27, 0.8);
              padding: 0.5rem;
              border-radius: 0.5rem;
            "
          ></div>
          <p>
            Bienvenido al sistema de gestión del Centro de Estudios San Ignacio.
            Accede con tus credenciales para acceder al panel de gestión.
          </p>
          <div id="login-select" class="login-select">
            <button id="estudiante" class="seleccionado">Estudiante</button>
            <button id="docente">Docente</button>
            <button id="admin">Administrativo</button>
          </div>
          <form
            method="POST"
            id="login-admin"
            action="login.php"
            class="container-login"
          >
            <div>
              <input type="email" name="correo" placeholder="Correo" required />
              <input
                type="password"
                name="contrasena"
                placeholder="Contraseña"
                required
              />
            </div>

            <button class="btn-login" type="submit">Iniciar sesión</button>
          </form>
          <form
            method="POST"
            id="login-docente"
            action="./api/auth/admin/login.php"
            class="container-login"
          >
            <div>
              <input type="email" name="correo" placeholder="Correo" required />
              <input
                type="password"
                name="contrasena"
                placeholder="Contraseña"
                required
              />
            </div>

            <button class="btn-login" type="submit">Iniciar sesión</button>
          </form>
          <form
            method="POST"
            id="login-estudiante"
            action="./api/auth/estudiante/login.php"
            class="container-login seleccionado"
          >
            <input
              class="formateador_rut"
              type="rut"
              name="rut"
              placeholder="Ingrese su RUT"
              required
            />
            <button class="btn-login" type="submit">Iniciar sesión</button>
          </form>
        </div>
      </div>
      <div class="fondo-login">
        <img
          src="/assets/icon/logo-2.svg"
          alt="Logo del Centro de Estudios San Ignacio"
          class="logo"
        />
      </div>
    </main>
  </body>
</html>
<script src="/public/js/script.js"></script>
<script>
  const params = new URLSearchParams(window.location.search);
  const error = params.get("error");
  if (error === "contrasena_incorrecta") {
    document.getElementById("mensaje-error").textContent =
      "❌ Contraseña incorrecta.";
    document.getElementById("mensaje-error").style.display = "block";
  }

  if (error === "correo_no_encontrado") {
    document.getElementById("mensaje-error").textContent =
      "❌ Correo no encontrado.";
    document.getElementById("mensaje-error").style.display = "block";
  } else if (error === "1") {
    document.getElementById("mensaje-error").textContent =
      "❌ Estudiante no encontrado.";
    document.getElementById("mensaje-error").style.display = "block";
  }

  document.querySelectorAll(".login-select button").forEach((btn) => {
    btn.addEventListener("click", () => {
      let botones = document.querySelectorAll(".login-select button");
      let containers = document.querySelectorAll(".container-login");

      botones.forEach((b) => {
        b.classList.remove("seleccionado");
      });

      containers.forEach((element) => {
        element.classList.remove("seleccionado");
      });

      const idButton = btn.id;
      const container = document.getElementById(`login-${idButton}`);

      container.classList.add("seleccionado");
      btn.classList.add("seleccionado");
    });
  });

  document.getElementById("login-estudiante").addEventListener("submit", () => {
    const input = document.getElementById("rut");

    // Quita puntos y guiones
    input.value = input.value.replace(/\./g, "");
  });
</script>
